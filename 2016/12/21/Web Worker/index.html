<!DOCTYPE html><html lang=""><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="author" content="jianjian"><title>Web Worker | imjianjian</title><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css"><script src="/js/script.js"></script><script src="/js/tocbot.min.js"></script></head><body><div class="wrapper"><header><nav class="navbar"><div class="container"><div class="navbar-header header-logo"><a href="/">imjianjian&#39;s Blog</a></div><div class="menu navbar-right"> <a class="menu-item" href="/archives">Posts</a> <a class="menu-item" href="/tags">Tags</a> <input id="switch_default" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div></nav><nav class="navbar-mobile" id="nav-mobile"><div class="container"><div class="navbar-header"><div> <a href="/">imjianjian&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a></div><div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div></div><div class="menu" id="mobile-menu"> <a class="menu-item" href="/archives">Posts</a> <a class="menu-item" href="/tags">Tags</a></div></div></nav></header><script>var mobileBtn=function(){var e=document.getElementsByClassName("menu-toggle")[0],t=document.getElementById("mobile-menu");e.classList.contains("active")?(e.classList.remove("active"),t.classList.remove("active")):(e.classList.add("active"),t.classList.add("active"))}</script><div class="main"><div class="container"><div class="post-toc"><div class="tocbot-list"></div><div class="tocbot-list-menu"> <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a> <a onclick="go_top()">Back to top</a> <a onclick="go_bottom()">Go to bottom</a></div></div><script>function expand_toc(){var o=document.querySelector(".tocbot-toc-expand");tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:6,orderedList:!1,scrollSmooth:!0}),o.setAttribute("onclick","collapse_toc()"),o.innerHTML="Collapse all"}function collapse_toc(){var o=document.querySelector(".tocbot-toc-expand");tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:1,orderedList:!1,scrollSmooth:!0}),o.setAttribute("onclick","expand_toc()"),o.innerHTML="Expand all"}function go_top(){window.scrollTo(0,0)}function go_bottom(){window.scrollTo(0,document.body.scrollHeight)}document.ready(function(){tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:1,orderedList:!1,scrollSmooth:!0})})</script><article class="post-wrap"><header class="post-header"><h1 class="post-title">Web Worker</h1><div class="post-meta"> Author: <a itemprop="author" rel="author" href="/">jianjian</a> <span class="post-time">Date: <a href="#">December 21, 2016&nbsp;&nbsp;20:35:50</a></span></div></header><div class="post-content"><h1 id="Web-Worker"><a href="#Web-Worker" class="headerlink" title="Web Worker"></a>Web Worker</h1><h2 id="1-Web-Worker是-运行在后台的javascript-也就是说worker其实就是就一个js文件对象，worker可以让他所包含的js代码运行在后台"><a href="#1-Web-Worker是-运行在后台的javascript-也就是说worker其实就是就一个js文件对象，worker可以让他所包含的js代码运行在后台" class="headerlink" title="1. Web Worker是 运行在后台的javascript,也就是说worker其实就是就一个js文件对象，worker可以让他所包含的js代码运行在后台"></a>1. Web Worker是 运行在后台的javascript,也就是说worker其实就是就一个js文件对象，worker可以让他所包含的js代码运行在后台</h2><h2 id="2-特点："><a href="#2-特点：" class="headerlink" title="2. 特点："></a>2. 特点：</h2><pre><code>1）充分利用多核CPU的优势
2）对多线程支持非常好
3）不会影响页面的性能
4）不能访问web页面和DOM API
5）所有的主流浏览器均支持web worker,除了Internet Explorer</code></pre><h2 id="3-Worker提供API"><a href="#3-Worker提供API" class="headerlink" title="3. Worker提供API"></a>3. Worker提供API</h2><pre><code>1）检测当前浏览器是否支持Worker

  typeof(Worker) !== &quot;undefined&quot;，如果浏览器返回true，则证明，浏览器支持Worker

2）创建Worker文件

   创建普通的 JS 文件，都可以用于 Web Worker 文件

3）创建Web Worker对象

    var worker = new Worker(&quot;myTime.js&quot;);

    参数就是在第二步创建的js文件的路径

4）worker事件

  onmessage事件

     用于监听 Web Worker 传递消息，通过回调函数接收传递的消息，通过回调函数的事件对象data 属性可以获取传递的消息

  postMessage()

     w.postMessage( “worker success.” );

     通过postMessage() 方法传递消息内容

  w.terminate();

     在HTML页面中，通过调用 Web Worker 对象的terminate( ) 方法终止 Web Worker。</code></pre><h1 id="用Worker实线一个简单的计数器"><a href="#用Worker实线一个简单的计数器" class="headerlink" title="用Worker实线一个简单的计数器"></a>用Worker实线一个简单的计数器</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;code&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;button id=&quot;start&quot;&gt;开始计时&lt;/button&gt;</span><br><span class="line">    &lt;button id=&quot;stop&quot;&gt;结束计时&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;br /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div id=&quot;showTime&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    var showTime = document.getElementById(&quot;showTime&quot;);</span><br><span class="line">    var start = document.getElementById(&quot;start&quot;).onclick = function() &#123;</span><br><span class="line">        //判断是否支持worker</span><br><span class="line">        if (typeof(Worker) !== &quot;undefined&quot;) &#123;</span><br><span class="line">            //创建js文件，把想运行在后台的js文件放在文件里</span><br><span class="line">            //创建worker对象,并执行内部代码</span><br><span class="line">            worker = new Worker(&quot;mytimer.js&quot;);</span><br><span class="line">            //绑定接受worker传来数据的事件</span><br><span class="line">            worker.onmessage = function(event) &#123;</span><br><span class="line">                showTime.innerHTML = event.data;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            console.log(&quot;你的浏览器不支持worker&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    var stop = document.getElementById(&quot;stop&quot;).onclick = function() &#123;</span><br><span class="line">        //终止worker</span><br><span class="line">        worker.terminate();</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;/code&gt;</span><br></pre></td></tr></table></figure><h1 id="mytimer-js文件"><a href="#mytimer-js文件" class="headerlink" title="mytimer.js文件"></a>mytimer.js文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var time = 0;</span><br><span class="line"></span><br><span class="line">function timer() &#123;</span><br><span class="line">    time++;</span><br><span class="line">    //从worker中发送数据</span><br><span class="line">    //worker中的全局变量，就是worker对象</span><br><span class="line">    postMessage(time);</span><br><span class="line">    console.log(time);</span><br><span class="line">    setTimeout(timer, 1000);</span><br><span class="line">&#125;</span><br><span class="line">timer();</span><br></pre></td></tr></table></figure></div><section class="post-copyright"><p class="copyright-item"> <span>Author:</span> <span>jianjian</span></p><p class="copyright-item"> <span>Permalink:</span> <span><a href="http://yoursite.com/2016/12/21/Web%20Worker/">http://yoursite.com/2016/12/21/Web%20Worker/</a></span></p><p class="copyright-item"> <span>License:</span> <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC-BY-NC-4.0</a> LICENSE</span></p><p class="copyright-item"> <span>Slogan:</span> <span>Do you believe in <strong>DESTINY<strong>?</strong></strong></span></p></section><section class="post-tags"><div> <span>Tag(s):</span> <span class="tag"><a href="/tags/web%E5%89%8D%E7%AB%AF/"># web前端</a></span></div><div> <a href="javascript:window.history.back();" target="_blank" rel="noopener">back</a> <span>·</span> <a href="/">home</a></div></section><section class="post-nav"> <a class="prev" rel="prev" href="/2016/12/22/web%E5%AD%98%E5%82%A8%E5%92%8Cweb-socket/">web存储和web socket</a></section></article></div></div><footer id="footer" class="footer"><div class="copyright"> <span>© jianjian | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span></div></footer></div></body></html>