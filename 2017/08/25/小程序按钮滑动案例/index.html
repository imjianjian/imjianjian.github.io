<!DOCTYPE html><html><head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=author content=jianjian><title>小程序按钮滑动案例 | imjianjian</title><link rel=icon href=/favicon.ico><link rel=stylesheet href=/css/style.css><script src=/js/script.js></script><script src=/js/tocbot.min.js></script></head><body><div class=wrapper><header><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href="/">imjianjian&#39;s Blog</a></div><div class="menu navbar-right"><a class=menu-item href=/archives>Posts</a> <a class=menu-item href=/tags>Tags</a> <input id=switch_default type=checkbox class=switch_default><label for=switch_default class=toggleBtn></label></div></div></nav><nav class=navbar-mobile id=nav-mobile><div class=container><div class=navbar-header><div><a href="/">imjianjian&#39;s Blog</a><a id=mobile-toggle-theme>·&nbsp;Light</a></div><div class=menu-toggle onclick=mobileBtn()>&#9776; Menu</div></div><div class=menu id=mobile-menu><a class=menu-item href=/archives>Posts</a> <a class=menu-item href=/tags>Tags</a></div></div></nav></header><script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script><div class=main><div class=container><div class=post-toc><div class=tocbot-list></div><div class=tocbot-list-menu><a class=tocbot-toc-expand onclick=expand_toc()>Expand all</a> <a onclick=go_top()>Back to top</a> <a onclick=go_bottom()>Go to bottom</a></div></div><script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script><article class=post-wrap><header class=post-header><h1 class=post-title>小程序按钮滑动案例</h1><div class=post-meta>Author: <a itemprop=author rel=author href="/">jianjian</a> <span class=post-time>Date: <a href=#>August 25, 2017&nbsp;&nbsp;10:25:00</a></span></div></header><div class=post-content><h1 id=一-先看东西><a href=#一-先看东西 class=headerlink title=一.先看东西></a>一.先看东西</h1><p><img src=http://upload-images.jianshu.io/upload_images/3132358-8ad6afc31cb7849d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240 alt=滑动前></p><p><img src=http://upload-images.jianshu.io/upload_images/3132358-fff67b844cf02fd5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240 alt=滑动后></p><h1 id=二-再上代码><a href=#二-再上代码 class=headerlink title=二.再上代码></a>二.再上代码</h1><h2 id=index-wxml><a href=#index-wxml class=headerlink title=index.wxml></a>index.wxml</h2><figure class="highlight plain"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><span class=line>&lt;view class=&quot;content&quot;&gt;</span><br><span class=line>    &lt;view class=&quot;sliderContent&quot;&gt;</span><br><span class=line>        &lt;input placeholder=&quot;验证码&quot; placeholder-class=&quot;input-placeholder&quot; disabled=&quot;&#123;&#123;disabled&#125;&#125;&quot; /&gt;</span><br><span class=line>        &lt;view class=&quot;slider&quot; bindtouchstart=&quot;moveSendBtnStart&quot; bindtouchend=&quot;moveSendBtnEnd&quot; bindtouchmove=&quot;moveSendBtn&quot; style=&quot;left:&#123;&#123;moveSendBtnLeft&#125;&#125;rpx;background-color:&#123;&#123;SendBtnColor&#125;&#125;&quot;&gt;发送&lt;/view&gt;</span><br><span class=line>    &lt;/view&gt;</span><br><span class=line>&lt;/view&gt;</span><br></pre></td></tr></table></figure><h2 id=index-wxss><a href=#index-wxss class=headerlink title=index.wxss></a>index.wxss</h2><figure class="highlight plain"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br></pre></td><td class=code><pre><span class=line></span><br><span class=line>.content &#123;</span><br><span class=line>    margin-top: 100rpx;</span><br><span class=line>    font-size: 24rpx;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line>.sliderContent&#123;</span><br><span class=line>    position: relative;</span><br><span class=line>    margin: 0 auto;</span><br><span class=line>    margin-bottom: 50rpx;</span><br><span class=line>    padding-left: 60rpx;</span><br><span class=line>    width: 425rpx;</span><br><span class=line>    box-sizing: border-box;</span><br><span class=line>    height: 70rpx;</span><br><span class=line>    line-height: 70rpx;</span><br><span class=line>    border-radius: 60rpx;</span><br><span class=line>    background-color: #fff;</span><br><span class=line>    color: #289adc;</span><br><span class=line>    box-shadow: 0px 4px 6px 0px rgba(37, 114, 219, 0.3);</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line>.sliderContent input &#123;</span><br><span class=line>    line-height: 70rpx;</span><br><span class=line>    height: 70rpx;</span><br><span class=line>    box-sizing: border-box;</span><br><span class=line>    padding-left: 40rpx;</span><br><span class=line>    width: 250rpx;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line>.input-placeholder &#123;</span><br><span class=line>    text-align: center;</span><br><span class=line>    color: #289adc;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line></span><br><span class=line> .slider &#123;</span><br><span class=line>    position: absolute;</span><br><span class=line>    top: 0;</span><br><span class=line>    left: 0;</span><br><span class=line>    width: 150rpx;</span><br><span class=line>    border-radius: 60rpx;</span><br><span class=line>    text-align: center;</span><br><span class=line>    background-color: #7f7f7f;</span><br><span class=line>    color: #fff;</span><br><span class=line>    box-shadow: 0px 4px 6px 0px rgba(37, 114, 219, 0.3);</span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><h2 id=index-js><a href=#index-js class=headerlink title=index.js></a>index.js</h2><figure class="highlight plain"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br></pre></td><td class=code><pre><span class=line></span><br><span class=line>Page(&#123;</span><br><span class=line>    data: &#123;</span><br><span class=line>        moveStartX: 0, //起始位置</span><br><span class=line>        moveSendBtnLeft: 0, //发送按钮的left属性</span><br><span class=line>        moveEndX: 0, //结束位置</span><br><span class=line>        screenWidth: 0, //屏幕宽度</span><br><span class=line>        moveable: true, //是否可滑动</span><br><span class=line>        disabled: true,//验证码输入框是否可用,</span><br><span class=line>        SendBtnColor: &quot;#7f7f7f&quot; //滑动按钮颜色</span><br><span class=line>    &#125;,</span><br><span class=line></span><br><span class=line>    onLoad: function () &#123;</span><br><span class=line>        var that = this;</span><br><span class=line>        // 获取屏幕宽度</span><br><span class=line>        wx.getSystemInfo(&#123;</span><br><span class=line>            success: function (res) &#123;</span><br><span class=line>                that.setData(&#123;</span><br><span class=line>                    screenWidth: res.screenWidth</span><br><span class=line>                &#125;)</span><br><span class=line>            &#125;,</span><br><span class=line>        &#125;)</span><br><span class=line>    &#125;,</span><br><span class=line>    //   开始移动</span><br><span class=line>    moveSendBtnStart: function (e) &#123;</span><br><span class=line>        if (!this.data.moveable) &#123;</span><br><span class=line>            return;</span><br><span class=line>        &#125;</span><br><span class=line>        console.log(&quot;start&quot;);</span><br><span class=line>        console.log(e);</span><br><span class=line>        this.setData(&#123;</span><br><span class=line>            moveStartX: e.changedTouches[&quot;0&quot;].clientX</span><br><span class=line>        &#125;)</span><br><span class=line>    &#125;,</span><br><span class=line>    //移动发送按钮</span><br><span class=line>    moveSendBtn: function (e) &#123;</span><br><span class=line>        if (!this.data.moveable) &#123;</span><br><span class=line>            return;</span><br><span class=line>        &#125;</span><br><span class=line>        var that = this;</span><br><span class=line>        // console.log(e.touches[0]);</span><br><span class=line>        var left = ((e.touches[0].clientX - that.data.moveStartX) / (that.data.screenWidth / 750))</span><br><span class=line>        console.log(left)</span><br><span class=line>        if (left &lt;= 275.5) &#123;</span><br><span class=line>            this.setData(&#123;</span><br><span class=line>                moveSendBtnLeft: left</span><br><span class=line>            &#125;)</span><br><span class=line>        &#125; else &#123;</span><br><span class=line></span><br><span class=line>            this.setData(&#123;</span><br><span class=line>                moveSendBtnLeft: 275.5</span><br><span class=line>            &#125;)</span><br><span class=line>        &#125;</span><br><span class=line>    &#125;,</span><br><span class=line>    // 结束移动</span><br><span class=line>    moveSendBtnEnd: function (e) &#123;</span><br><span class=line>        console.log(&quot;end&quot;);</span><br><span class=line>        var that = this;</span><br><span class=line>        var left = ((e.changedTouches[0].clientX - that.data.moveStartX) / (that.data.screenWidth / 750))</span><br><span class=line>        console.log(left);</span><br><span class=line>        if (left &lt; 275.5) &#123;</span><br><span class=line>            for (let i = left; i &gt;= 0; i--) &#123;</span><br><span class=line></span><br><span class=line>                that.setData(&#123;</span><br><span class=line>                    moveSendBtnLeft: i</span><br><span class=line>                &#125;)</span><br><span class=line>            &#125;</span><br><span class=line>        &#125; else &#123;</span><br><span class=line>            that.setData(&#123;</span><br><span class=line>                moveEndX: e.changedTouches[0].clientX,</span><br><span class=line>                moveable: false,</span><br><span class=line>                disabled: false,</span><br><span class=line>                SendBtnColor: &quot;#289adc&quot;</span><br><span class=line>            &#125;)</span><br><span class=line>        &#125;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line></span><br><span class=line>&#125;)</span><br></pre></td></tr></table></figure><h1 id=三-顺便说说><a href=#三-顺便说说 class=headerlink title=三.顺便说说></a>三.顺便说说</h1><h2 id=1-按钮滑动事件><a href=#1-按钮滑动事件 class=headerlink title=1.按钮滑动事件></a>1.按钮滑动事件</h2><p>bindtouchstart //按钮开始滑动<br>bindtouchend //按钮结束滑动<br>bindtouchmove //按钮正在滑动</p><p>在按钮开始滑动是记录开始的位置<br>滑动结束时要判断按钮是否已经滑动到最右侧，如果只滑动到中间，则弹回</p><p>滑动过程中要计算与初始位置的距离，然后计算并改变button的left属性值</p><h2 id=2-按钮滑动的距离计算><a href=#2-按钮滑动的距离计算 class=headerlink title=2.按钮滑动的距离计算></a>2.按钮滑动的距离计算</h2><p>因为滑动事件返回的数值都是以px作为单位，而我们在界面设计时使用的是rpx，在这里我们要进行数值计算<br>在onLoad中，我们获取到当前设备的宽度<br>rpx作为单位时，认为当前设备的逻辑宽度为750rpx<br>假设屏幕实际宽度为400px，那么1px = 400/750 rpx<br>那么滑动的距离 = 实际互动距离 / （400/750） rpx<br>经过换算后，我们就可以得到以rpx作为单位的滑动距离</p></div><section class=post-copyright><p class=copyright-item><span>Author:</span> <span>jianjian</span></p><p class=copyright-item><span>Permalink:</span> <span><a href="http://yoursite.com/2017/08/25/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8C%89%E9%92%AE%E6%BB%91%E5%8A%A8%E6%A1%88%E4%BE%8B/">http://yoursite.com/2017/08/25/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8C%89%E9%92%AE%E6%BB%91%E5%8A%A8%E6%A1%88%E4%BE%8B/</a></span></p><p class=copyright-item><span>License:</span> <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/" target=_blank rel=noopener>CC-BY-NC-4.0</a> LICENSE</span></p><p class=copyright-item><span>Slogan:</span> <span>Do you believe in <strong>DESTINY<strong>?</strong></strong></span></p></section><section class=post-tags><div><span>Tag(s):</span> <span class=tag><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"># 微信小程序</a></span></div><div><a href=javascript:window.history.back(); target=_blank rel=noopener>back</a> <span>·</span> <a href="/">home</a></div></section><section class=post-nav><a class=prev rel=prev href="/2017/12/30/MongoDB%20%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/">MongoDB安装与配置</a> <a class=next rel=next href="/2017/08/24/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%E4%B8%AD%E9%81%87%E5%9D%91%E9%9B%86/">小程序开发遇坑集</a></section></article></div></div><footer id=footer class=footer><div class=copyright><span>© jianjian | Powered by <a href=https://hexo.io target=_blank>Hexo</a> & <a href=https://github.com/Siricee/hexo-theme-Chic target=_blank>Chic</a></span></div></footer></div></body></html>