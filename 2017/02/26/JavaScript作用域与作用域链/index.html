<!DOCTYPE html><html><head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=author content=jianjian><title>JavaScript作用域与作用域链 | imjianjian</title><link rel=icon href=/favicon.ico><link rel=stylesheet href=/css/style.css><script src=/js/script.js></script><script src=/js/tocbot.min.js></script></head><body><div class=wrapper><header><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href="/">imjianjian&#39;s Blog</a></div><div class="menu navbar-right"><a class=menu-item href=/archives>Posts</a> <a class=menu-item href=/tags>Tags</a> <input id=switch_default type=checkbox class=switch_default><label for=switch_default class=toggleBtn></label></div></div></nav><nav class=navbar-mobile id=nav-mobile><div class=container><div class=navbar-header><div><a href="/">imjianjian&#39;s Blog</a><a id=mobile-toggle-theme>·&nbsp;Light</a></div><div class=menu-toggle onclick=mobileBtn()>&#9776; Menu</div></div><div class=menu id=mobile-menu><a class=menu-item href=/archives>Posts</a> <a class=menu-item href=/tags>Tags</a></div></div></nav></header><script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script><div class=main><div class=container><div class=post-toc><div class=tocbot-list></div><div class=tocbot-list-menu><a class=tocbot-toc-expand onclick=expand_toc()>Expand all</a> <a onclick=go_top()>Back to top</a> <a onclick=go_bottom()>Go to bottom</a></div></div><script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script><article class=post-wrap><header class=post-header><h1 class=post-title>JavaScript作用域与作用域链</h1><div class=post-meta>Author: <a itemprop=author rel=author href="/">jianjian</a> <span class=post-time>Date: <a href=#>February 26, 2017&nbsp;&nbsp;16:21:23</a></span></div></header><div class=post-content><h1 id=一、JavaScript作用域><a href=#一、JavaScript作用域 class=headerlink title=一、JavaScript作用域></a>一、JavaScript作用域</h1><p>任何程序设计语言都有作用域的概念，简单的说，作用域就是变量与函数的可访问范围，即作用域控制着变量与函数的可见性和生命周期。在JavaScript中，变量的作用域有全局作用域和局部作用域两种。</p><h2 id=1-全局作用域-Global-Scope><a href=#1-全局作用域-Global-Scope class=headerlink title="1. 全局作用域(Global Scope)"></a>1. 全局作用域(Global Scope)</h2><p>在代码中任何地方都能访问到的对象拥有全局作用域，一般来说一下几种情形拥有全局作用域：</p><p>(1)最外层函数和在最外层函数外面定义的变量拥有全局作用域，例如：<br>var authorName=”Burce_zxy”;function doSomething(){var blogName=”旅行的意义zxy”;function innerSay(){alert(blogName);}innerSay();}alert(authorName); //Bruce_zxyalert(blogName); //脚本错误doSomething(); //旅行的意义zxyinnerSay() //脚本错误</p><p>(2)所有末定义直接赋值的变量自动声明为拥有全局作用域，例如：<br>function doSomething(){var authorName=”Bruce_zxy”;blogName=”旅行的意义zxy”;alert(authorName);}alert(blogName); //旅行的意义zxyalert(authorName); //脚本错误<br>变量blogName拥有全局作用域，而authorName在函数外部无法访问到。</p><p>(3)所有window对象的属性拥有全局作用域<br>一般情况下，window对象的内置属性都都拥有全局作用域，例如window.name、window.location、window.top等等。</p><h2 id=2-局部作用域-Local-Scope><a href=#2-局部作用域-Local-Scope class=headerlink title="2. 局部作用域(Local Scope)"></a>2. 局部作用域(Local Scope)</h2><p>和全局作用域相反，局部作用域一般只在固定的代码片段内可访问到，最常见的例如函数内部，所有在一些地方也会看到有人把这种作用域成为函数作用域，例如下列代码中的blogName和函数innerSay都只拥有局部作用域。<br>function doSomething(){var blogName=”旅行的意义zxy”;function innerSay(){alert(blogName);}innerSay();}alert(blogName); //脚本错误innerSay(); //脚本错误</p><h1 id=二、作用域链-Scope-Chain><a href=#二、作用域链-Scope-Chain class=headerlink title="二、作用域链(Scope Chain)"></a>二、作用域链(Scope Chain)</h1><p>在JavaScript中，函数也是对象，实际上，JavaScript里一切都是对象。函数对象和其它对象一样，拥有可以通过代码访问的属性和一系列仅供JavaScript引擎访问的内部属性。其中一个内部属性是[[Scope]]，由ECMA-262标准第三版定义，该内部属性包含了函数被创建的作用域中对象的集合，这个集合被称为函数的作用域链，它决定了哪些数据能被函数访问。<br>当一个函数创建后，它的作用域链会被创建此函数的作用域中可访问的数据对象填充。例如定义下面这样一个函数：</p><p>function add(num1,num2) {var sum = num1 + num2;return sum;}<br>在函数add创建时，它的作用域链中会填入一个全局对象，该全局对象包含了所有全局变量。如下图所示(注意：图片只例举了全部变量中的一部分)：<img src=http://upload-images.jianshu.io/upload_images/3132358-279d0ec7641bda8a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240></p><p>函数add的作用域将会在执行时用到。例如执行如下代码：</p><p>var total = add(5,10);<br>执行此函数时会创建一个称为“运行期上下文(execution context)”的内部对象，运行期上下文定义了函数执行时的环境。每个运行期上下文都有自己的作用域链，用于标识符解析，当运行期上下文被创建时，而它的作用域链初始化为当前运行函数的[[Scope]]所包含的对象。这些值按照它们出现在函数中的顺序被复制到运行期上下文的作用域链中。它们共同组成了一个新的对象，叫“活动对象(activation object)”，该对象包含了函数的所有局部变量、命名参数、参数集合以及this，然后此对象会被推入作用域链的前端，当运行期上下文被销毁，活动对象也随之销毁。新的作用域链如下图所示：<br><img src=http://upload-images.jianshu.io/upload_images/3132966-fce8807bd9bbbb26.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240></p><p>在函数执行过程中，没遇到一个变量，都会经历一次标识符解析过程以决定从哪里获取和存储数据。该过程从作用域链头部，也就是从活动对象开始搜索，查找同名的标识符，如果找到了就使用这个标识符对应的变量，如果没找到继续搜索作用域链中的下一个对象，如果搜索完所有对象都未找到，则认为该标识符未定义。函数执行过程中，每个标识符都要经历这样的搜索过程。</p></div><section class=post-copyright><p class=copyright-item><span>Author:</span> <span>jianjian</span></p><p class=copyright-item><span>Permalink:</span> <span><a href="http://yoursite.com/2017/02/26/JavaScript%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE/">http://yoursite.com/2017/02/26/JavaScript%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE/</a></span></p><p class=copyright-item><span>License:</span> <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/" target=_blank rel=noopener>CC-BY-NC-4.0</a> LICENSE</span></p><p class=copyright-item><span>Slogan:</span> <span>Do you believe in <strong>DESTINY<strong>?</strong></strong></span></p></section><section class=post-tags><div><span>Tag(s):</span> <span class=tag><a href="/tags/JavaScript/"># JavaScript</a></span></div><div><a href=javascript:window.history.back(); target=_blank rel=noopener>back</a> <span>·</span> <a href="/">home</a></div></section><section class=post-nav><a class=prev rel=prev href="/2017/02/26/JavaScript%E6%A8%A1%E5%9D%97%E6%A8%A1%E5%BC%8F/">JavaScript模块模式</a> <a class=next rel=next href="/2017/02/17/bootstrap%E4%B9%8B%E6%A0%BC%E6%A0%85%E5%8C%96%E5%B8%83%E5%B1%80%E5%92%8C%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/">bootstrap之格栅化布局和常用组件</a></section></article></div></div><footer id=footer class=footer><div class=copyright><span>© jianjian | Powered by <a href=https://hexo.io target=_blank>Hexo</a> & <a href=https://github.com/Siricee/hexo-theme-Chic target=_blank>Chic</a></span></div></footer></div></body></html>